var LimitFps=pc.createScript("limitFps");LimitFps.attributes.add("targetFps",{type:"number",default:30}),LimitFps.prototype.initialize=function(){this.app;this.limit(this.targetFps),this.app.on("attr:targetFps",(function(t,i){this.limit(t)}))},LimitFps.prototype.limit=function(t){var i=this.app;this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null),i.autoRender=!1,this.intervalId=setInterval((function(){i.renderNextFrame=!0}),1e3/t)};var Game=pc.createScript("game");Game.attributes.add("timerText",{type:"entity"}),Game.attributes.add("uiMenu",{type:"entity"}),Game.attributes.add("uiInGame",{type:"entity"}),Game.attributes.add("uiGameOver",{type:"entity"}),Game.attributes.add("audio",{type:"entity"}),Game.STATE_MENU="menu",Game.STATE_INGAME="ingame",Game.STATE_GAMEOVER="gameover",Game.prototype.initialize=function(){this._state=Game.STATE_MENU,this._score=0,this.setResolution(),window.addEventListener("resize",this.setResolution.bind(this)),this.app.on("ui:start",this.start,this),this.app.on("ui:reset",this.reset,this),this.isConnected=!1,this.prizeMultiplier=0,this.prizeType="CREDIT",this.gameActive=!1,this.timeRemaining=30,this.timerActive=!1,this.startTimer()},Game.prototype.setResolution=function(){var e=this.app,t=window.innerWidth,i=window.innerHeight,n=16/9;if(t/i>n){var a=Math.min(t/i,n)*i;e.graphicsDevice.width=a,e.graphicsDevice.height=i,e.resizeCanvas(a,i),console.log("hit first if")}else{a=Math.min(t/i,n)*i;e.graphicsDevice.width=a,e.graphicsDevice.height=i,e.resizeCanvas(a,i),console.log("hit second if")}var o=e.root.findByName("Camera");o&&o.camera&&(o.camera.aspectRatio=t/i,console.log("hit camera"))},Game.prototype.start=function(){this._state=Game.STATE_INGAME,this.app.fire("game:start"),this.uiMenu.enabled=!1,this.uiInGame.enabled=!0},Game.prototype.gameOver=function(){console.log("jordan hit gameOver"),this._state=Game.STATE_GAMEOVER,this.app.fire("game:gameover"),this.uiInGame.enabled=!1,this.audio.sound.stop()},Game.prototype.reset=function(){this.app.fire("game:reset"),this.resetScore(),this._state=Game.STATE_MENU,this.uiGameOver.enabled=!1,this.uiMenu.enabled=!0,this.audio.sound.stop()},Game.prototype.getScore=function(){return this._score},Game.prototype.addScore=function(e){this._score+=e},Game.prototype.resetScore=function(){this._score=0,this.app.fire("game:score",this._score)},Game.prototype.startTimer=function(){this.timeRemaining=30,this.timerActive=!0,this.updateTimerText(),this.timerInterval=setInterval(function(){this.timeRemaining>0?(this.timeRemaining--,this.updateTimerText()):(this.timerActive=!1,clearInterval(this.timerInterval),this.onTimerEnd())}.bind(this),1e3)},Game.prototype.updateTimerText=function(){this.timerText&&this.timerText.element&&(this.timerText.element.text=this.timeRemaining)},Game.prototype.onTimerEnd=function(){console.log("Timer ended"),this.onGameOver()},Game.prototype.getCurrentPrize=function(e){return"CASH"==this.prizeType?Math.round(e*this.prizeMultiplier*100)/100:Math.floor(e*this.prizeMultiplier)},Game.prototype.onGameOver=function(){if(this.gameActive||!this.isConnected){console.log("jordan hit onGameOver"),console.log(this._score);var e=Math.round(this._score);this.gameActive=!1,this.gameOver(),this.onGameComplete(e,this.getCurrentPrize(e),this.prizeType,this.prizeMultiplier),setTimeout((()=>{this.reset()}),500)}},Game.prototype.sendRNEvent=function(e){window.ReactNativeWebView&&window.ReactNativeWebView.postMessage(JSON.stringify(e))},Game.prototype.trackEvent=function(e,t){this.sendRNEvent({eventType:"TRACK_EVENT",eventName:e,eventData:JSON.stringify(t||{})})},Game.prototype.onConnected=function(){this.isConnected=!0,this.trackEvent("minigame - connected")},Game.prototype.onStartSuccess=function(){this.gameActive=!0},Game.prototype.onStartError=function(){this.gameActive=!1},Game.prototype.onGameComplete=function(e,t,i,n){this.sendRNEvent({eventType:"GAME_COMPLETED",score:e,prizeAmount:t,prizeType:i,multiplier:n})},Game.prototype.setPrize=function(e,t){this.prizeType=e,this.prizeMultiplier=t},Game.prototype.onEnableAudio=function(){},Game.prototype.onDisableAudio=function(){},window.onRNEvent=function(e){var t=pc.Application.getApplication().root.findByName("Game").script.game,i=JSON.parse(e);switch(i.eventType){case"CONNECTED":t.onConnected();break;case"SET_PRIZES":t.setPrize(i.prizeType,i.multiplier);break;case"START_SUCCESS":t.onStartSuccess();break;case"START_ERROR":t.onStartError();break;case"ENABLE_AUDIO":t.onEnableAudio();break;case"DISABLE_AUDIO":t.onDisableAudio()}},window.onPcLoad=function(){app.root.findByName("Game").script.game.sendRNEvent({eventType:"LOAD_COMPLETE"})};var Ball=pc.createScript("ball");Ball.attributes.add("scoreText",{type:"entity"}),Ball.attributes.add("throwForce",{type:"number",default:575}),Ball.attributes.add("torque",{type:"number",default:10}),Ball.attributes.add("scaleDuration",{type:"number",default:.66}),Ball.attributes.add("ballRimScale",{type:"number",default:.75}),Ball.attributes.add("ballSpawnScale",{type:"number",default:1.9}),Ball.attributes.add("randomX",{type:"number",default:1}),Ball.attributes.add("shadowMagnitude",{type:"number",default:.6}),Ball.attributes.add("fixBounceX",{type:"number",default:.1}),Ball.attributes.add("gravity",{type:"number",default:-9.8,description:"The value of gravity to use"}),Ball.attributes.add("defaultTap",{type:"number",default:5,description:"Speed to set the ball to when it is tapped"}),Ball.attributes.add("impactEffect",{type:"entity",description:"The particle effect to trigger when the ball is tapped"}),Ball.attributes.add("ballMinimum",{type:"number",default:-6,description:"When ball goes below minimum y value game over is triggered"}),Ball.attributes.add("speedMult",{type:"number",default:4,description:"Multiplier to apply to X speed when tap is off center"}),Ball.attributes.add("angMult",{type:"number",default:-6,description:"Multiplier to apply to angular speed when tap is off center"}),Ball.attributes.add("triggerActivated",{type:"boolean",default:!1,description:"Flag to track if the trigger has been activated for the current throw"}),Ball.prototype.initialize=function(){this.triggerActivated=!1,this.app.systems.rigidbody.gravity=new pc.Vec3(0,0,0),this.game=this.app.root.findByName("Game"),this.gameScript=this.app.root.findByName("Game").script.game,this.entity.collision.on("collisionstart",this.onCollisionStart,this),this.rimHit=!1},Ball.prototype.update=function(t){this.entity.getLocalPosition().y<this.ballMinimum-1.5&&(this.entity.rigidbody.teleport(0,-2.135,1),this.entity.rigidbody.linearVelocity=pc.Vec3.ZERO,this.entity.setEulerAngles(0,0,0),this.entity.rigidbody.angularVelocity=pc.Vec3.ZERO,this.app.systems.rigidbody.gravity=new pc.Vec3(0,0,0),this.startAnimation("Reset"),this.triggerActivated=!1,this.rimHit=!1,this.app.root.findByName("BottomTrigger").rigidbody.enabled=!0,this.entity.rigidbody.enabled=!1)},Ball.prototype.throw=function(t,e){this.entity.rigidbody.enabled=!0,this.entity.rigidbody.enabled=!0,this.startAnimation("Throw2");var i=new pc.Vec3(t.x,t.y,0).normalize().scale(this.throwForce*e);this.entity.rigidbody.applyForce(.5*i.x,625,-100),this.entity.rigidbody.applyForce(.5*i.x,625,-100),console.log(.5*i.x,375,-250);t.x;console.log("direction x"+t.x),t.x<0?this.entity.rigidbody.applyTorque(0,0,-30):this.entity.rigidbody.applyTorque(0,0,30),this.entity.force,this.scheduleGravity(),this.moving=!0},Ball.prototype.scheduleGravity=function(){setTimeout(function(){this.app.systems.rigidbody.gravity=new pc.Vec3(0,-20.8,0),console.log(this.entity.rigidbody.linearVelocity),console.log(this.entity.rigidbody.linearFactor),console.log(this.entity.rigidbody.linearDamping),console.log(this.entity.rigidbody.enabled)}.bind(this),0),setTimeout(function(){this.app.systems.rigidbody.gravity=new pc.Vec3(0,-40,0),console.log(this.entity.rigidbody.linearVelocity),console.log(this.entity.rigidbody.linearFactor),console.log(this.entity.rigidbody.linearDamping),console.log(this.entity.rigidbody.enabled)}.bind(this),550)},Ball.prototype.startAnimation=function(t){var e=this.entity.script.motion;e?(console.log("jordan played"+t),e.onMotionPlay(t)):console.warn("Motion script not found on the entity")},Ball.prototype.onCollisionStart=function(t){"BottomTrigger"!==t.other.name||this.triggerActivated||(console.log("Ball has hit the BottomTrigger!"),this.startAnimation("Disappear"),t.other.rigidbody&&console.log("disabled bottomTrigger"),this.entity.rigidbody.teleport(0,this.ballMinimum-2,1),this.triggerActivated=!0,this.gameScript&&(console.log(this.gameScript.getScore()+"jordan"),this.app.root.findByName("Ingame Screen").enabled=!0,!0===this.rimHit?(this.app.fire("game:score","+2"),this.gameScript.addScore(2)):(this.app.fire("game:score","+3"),this.gameScript.addScore(3)),this.scoreText.element.text=this.gameScript.getScore(),setTimeout(function(){this.app.root.findByName("Ingame Screen").enabled=!1}.bind(this),1500))),t.other.tags&&t.other.tags.has("rimPart")&&(console.log("Ball has hit a part of the rim!"),this.startAnimation("Bounce2"),this.rimHit=!0)},Ball.prototype.onTouchEnd=function(t){console.log("on touch end hit")};var TouchController=pc.createScript("touchController");TouchController.attributes.add("ball",{type:"entity"}),TouchController.attributes.add("minSwipeMagnitude",{type:"number",default:.3}),TouchController.attributes.add("maxSwipeMagnitude",{type:"number",default:10}),TouchController.attributes.add("maxBallY",{type:"number",default:.15}),TouchController.attributes.add("camera",{type:"entity"}),TouchController.attributes.add("ballRadius",{type:"number",default:1}),TouchController.prototype.initialize=function(){this.touch=!1,this.startPosition=new pc.Vec2,this.currentPosition=new pc.Vec2,this.lastPosition=new pc.Vec2,this.app.touch&&(this.app.touch.on("touchstart",this.onTouchStart,this),this.app.touch.on("touchmove",this.onTouchMove,this),this.app.touch.on("touchend",this.onTouchEnd,this)),this.app.mouse.on(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.app.mouse.on(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),this.app.mouse.on(pc.EVENT_MOUSEUP,this.onMouseUp,this)},TouchController.prototype.onTouchStart=function(t){var o=t.touches[0],i=new pc.Vec2(o.x,o.y),e=this.screenToWorld(i.x,i.y,this.ball.getPosition().z),s=e.x-this.ball.getPosition().x,n=e.y-this.ball.getPosition().y;s*s+n*n<this.ballRadius*this.ballRadius&&(console.log("on touch start"),this.startPosition.set(o.x,o.y),this.touch=!0)},TouchController.prototype.screenToWorld=function(t,o,i){var e=new pc.Vec3(t,o,i);return this.camera.camera.screenToWorld(e.x,e.y,e.z)},TouchController.prototype.onTouchMove=function(t){if(this.touch){var o=t.touches[0],i=new pc.Vec2(o.x,o.y),e=this.screenToWorld(this.startPosition.x,this.startPosition.y,this.ball.getPosition().z),s=this.screenToWorld(i.x,i.y,this.ball.getPosition().z);console.log(i.x,i.y,this.ball.getPosition().z),console.log(this.startPosition.x,this.startPosition.y,this.ball.getPosition().z);var n=s.sub(e),h=i.sub(this.startPosition).length();if(n.y>0){var l=Math.min(n.y/this.maxSwipeMagnitude*this.maxBallY,this.maxBallY),r=1-l/this.maxBallY*.0175,a=this.ball.getPosition().clone();if(a.y+=l+.01,this.ball.setPosition(a),h>=this.maxSwipeMagnitude)return console.log("ball is thrown"),this.ball.script.ball.throw(new pc.Vec3(n.x,n.y,0).normalize(),r),void(this.touch=!1)}}},TouchController.prototype.onTouchEnd=function(t){console.log("on touch end hit")},TouchController.prototype.onMouseDown=function(t){var o={touches:[{x:t.x,y:t.y}]};this.onTouchStart(o)},TouchController.prototype.onMouseMove=function(t){if(this.touch){var o={touches:[{x:t.x,y:t.y}]};this.onTouchMove(o)}},TouchController.prototype.onMouseUp=function(t){if(this.touch){var o={changedTouches:[{x:t.x,y:t.y}]};this.onTouchEnd(o)}};var Motion=pc.createScript("motion");Motion.attributes.add("motions",{type:"json",schema:[{name:"name",type:"string"},{name:"position",type:"curve",curves:["x","y","z"]},{name:"rotation",type:"curve",curves:["x","y","z"]},{name:"scale",type:"curve",curves:["x","y","z"]},{name:"speed",type:"number",default:1},{name:"autoplay",type:"boolean",default:!1},{name:"loop",type:"boolean",default:!1}],array:!0}),Motion.attributes.add("events",{type:"json",schema:[{name:"animationName",type:"string"},{name:"eventName",type:"string"},{name:"time",type:"number",default:1},{name:"type",type:"string",default:"Anytime",enum:[{Anytime:"Anytime"},{Start:"Start"},{End:"End"}]}],array:!0}),Motion.attributes.add("lerp",{type:"number",default:.5}),Motion.prototype.initialize=function(){this.timestamp=0,this.currentSpeed=0,this.currentMotion=!1,this.isReverting=!1,this.startPosition=this.entity.getLocalPosition().clone(),this.startRotation=this.entity.getLocalEulerAngles().clone(),this.startScale=this.entity.getLocalScale().clone(),this.position=new pc.Vec3(0,0,0),this.rotation=new pc.Vec3(0,0,0),this.scale=new pc.Vec3(0,0,0),this.motions.length>0&&this.motions[0].autoplay&&this.onMotionPlay(this.motions[0].name),this.app.on("Motion",this.onMotionPlay,this),this.app.on("Motion:Stop",this.onMotionStop,this),this.entity.on("Motion",this.onMotionPlay,this),this.entity.on("Motion:Stop",this.onMotionStop,this)},Motion.prototype.findMotion=function(t){var i=!1;for(var n in this.motions){var e=this.motions[n];e.name==t&&(i=e)}return i},Motion.prototype.onMotionStop=function(t){this.currentMotion&&this.currentMotion.name==t&&(this.isPlaying=!1,this.currentMotion=!1)},Motion.prototype.onMotionPlay=function(t,i){if(!i&&this.currentMotion&&this.currentMotion.name==t)return!1;var n=this.findMotion(t);if(console.log("jordan motion"+n),!n)return!1;this.isPlaying=!0,this.timestamp=0,this.currentMotion=n,this.triggerStartEvent(this.currentMotion)},Motion.prototype.triggerEvents=function(t){for(var i in this.events){var n=this.events[i],e=n.time;n.animationName==this.currentMotion.name&&e>this.timestamp&&e<=this.timestamp+t&&this.app.fire(n.eventName)}},Motion.prototype.findEventByMotion=function(t,i){for(var n in this.events){var e=this.events[n];if(e.animationName==t.name&&e.type==i)return e}},Motion.prototype.triggerStartEvent=function(t){var i=this.findEventByMotion(t,"Start");i&&this.app.fire(i.eventName)},Motion.prototype.triggerEndEvent=function(t){var i=this.findEventByMotion(t,"End");i&&this.app.fire(i.eventName)},Motion.prototype.update=function(t){if(!this.isPlaying)return!1;if(!this.currentMotion)return!1;var i=this.currentMotion.position.value(this.timestamp),n=this.currentMotion.rotation.value(this.timestamp),e=this.currentMotion.scale.value(this.timestamp);this.position=this.position.lerp(this.position,new pc.Vec3(i[0],i[1],i[2]),this.lerp),this.rotation=this.rotation.lerp(this.rotation,new pc.Vec3(n[0],n[1],n[2]),this.lerp),this.scale=this.scale.lerp(this.scale,new pc.Vec3(e[0],e[1],e[2]),this.lerp),this.entity.setLocalPosition(this.position.clone().add(this.startPosition)),this.entity.setLocalEulerAngles(this.rotation.clone().add(this.startRotation)),this.entity.setLocalScale(this.scale.clone().add(this.startScale)),this.triggerEvents(t),this.timestamp>=1&&(this.isPlaying=!1,this.currentMotion.loop?this.onMotionPlay(this.currentMotion.name,!0):(this.triggerEndEvent(this.currentMotion),this.currentMotion=!1)),this.isReverting?(this.timestamp-=t*this.currentMotion.speed,this.timestamp<=0&&(this.triggerEndEvent(this.currentMotion),this.currentMotion=!1,this.isPlaying=!1,this.isReverting=!1)):this.timestamp+=t*this.currentMotion.speed,this.timestamp=Math.max(this.timestamp,0),this.timestamp=Math.min(this.timestamp,1)};var UiScore=pc.createScript("uiScore");UiScore.prototype.initialize=function(){this.score=this.entity.findByName("Score"),this.on("enable",this.onEnable,this),this.on("disable",this.onDisable,this),this.onEnable()},UiScore.prototype.onEnable=function(){this.app.on("game:score",this._changeScore,this),this._changeScore(0)},UiScore.prototype.onDisable=function(){this.app.off("game:score",this._changeScore,this)},UiScore.prototype._changeScore=function(e){this.score.element.text=e};var UiGameover=pc.createScript("uiGameover");UiGameover.attributes.add("overlay",{type:"entity"}),UiGameover.prototype.initialize=function(){},UiGameover.prototype.onEnable=function(){},UiGameover.prototype.onDisable=function(){},UiGameover.prototype.reset=function(e){};var UiMenu=pc.createScript("uiMenu");UiMenu.attributes.add("overlay",{type:"entity"}),UiMenu.prototype.initialize=function(){this.on("enable",this.onEnable,this),this.on("disable",this.onDisable,this),this.onEnable()},UiMenu.prototype.onEnable=function(){this.overlay.enabled=!0,this.overlay.element.on("click",this.start,this),this.ball&&(this.ball.model.meshInstances[0].material.depthTest=!1)},UiMenu.prototype.onDisable=function(){this.overlay.enabled=!1,this.overlay.element.off("click",this.start,this)},UiMenu.prototype.start=function(t){this.app.fire("ui:start"),t.stopPropagation()};var Bottomtrigger=pc.createScript("bottomtrigger");Bottomtrigger.prototype.initialize=function(){this.entity.collision.on("triggerenter",(function(t){console.log(t.name+" has entered trigger volume.")})),this.entity.collision.on("triggerleave",(function(t){console.log(t.name+" has left trigger volume.")}))},Bottomtrigger.prototype.update=function(t){};var MoveBackAndForth=pc.createScript("moveBackAndForth");MoveBackAndForth.attributes.add("moveRange",{type:"number",default:2.5}),MoveBackAndForth.attributes.add("speed",{type:"number",default:1}),MoveBackAndForth.prototype.initialize=function(){this.initialX=this.entity.getPosition().x},MoveBackAndForth.prototype.update=function(t){var e=this.entity.getPosition();e.x=this.initialX+Math.sin(pc.app.timeScale*this.speed*pc.app._time)*this.moveRange,this.entity.setPosition(e)};var Input=pc.createScript("input");Input.attributes.add("ball",{type:"entity"}),Input.attributes.add("camera",{type:"entity"}),Input.attributes.add("ballRadius",{type:"number",default:.5}),Input.worldPos=new pc.Vec3,Input.prototype.initialize=function(){var t=this;this._paused=!0,this.app.on("game:start",(function(){t._paused=!1})),this.app.on("game:gameover",(function(){t._paused=!0})),this.app.touch&&this.app.touch.on("touchstart",this._onTouchStart,this),this.app.mouse.on("mousedown",this._onMouseDown,this)},Input.prototype._onTap=function(t,a){var o=this.ball.getPosition(),n=this.camera.getPosition(),e=Input.worldPos;this.camera.camera.screenToWorld(t,a,n.z,e);o.x,e.x,o.y,e.y;this.ballRadius,this.ballRadius},Input.prototype._onTouchStart=function(t){if(!this._paused){var a=t.changedTouches[0];this._onTap(a.x,a.y),t.event.preventDefault()}},Input.prototype._onMouseDown=function(t){this._paused||this._onTap(t.x,t.y)};"undefined"!=typeof document&&(
/*! FPSMeter 0.3.1 - 9th May 2013 | https://github.com/Darsain/fpsmeter */
function(t,e){function s(t,e){for(var n in e)try{t.style[n]=e[n]}catch(t){}return t}function H(t){return null==t?String(t):"object"==typeof t||"function"==typeof t?Object.prototype.toString.call(t).match(/\s([a-z]+)/i)[1].toLowerCase()||"object":typeof t}function R(t,e){if("array"!==H(e))return-1;if(e.indexOf)return e.indexOf(t);for(var n=0,o=e.length;n<o;n++)if(e[n]===t)return n;return-1}function I(){var t,e=arguments;for(t in e[1])if(e[1].hasOwnProperty(t))switch(H(e[1][t])){case"object":e[0][t]=I({},e[0][t],e[1][t]);break;case"array":e[0][t]=e[1][t].slice(0);break;default:e[0][t]=e[1][t]}return 2<e.length?I.apply(null,[e[0]].concat(Array.prototype.slice.call(e,2))):e[0]}function N(t){return 1===(t=Math.round(255*t).toString(16)).length?"0"+t:t}function S(t,e,n,o){t.addEventListener?t[o?"removeEventListener":"addEventListener"](e,n,!1):t.attachEvent&&t[o?"detachEvent":"attachEvent"]("on"+e,n)}function D(t,e){function g(t,e,n,o){return h[0|t][Math.round(Math.min((e-n)/(o-n)*M,M))]}function r(){F.legend.fps!==q&&(F.legend.fps=q,F.legend[c]=q?"FPS":"ms"),b=q?v.fps:v.duration,F.count[c]=999<b?"999+":b.toFixed(99<b?0:O.decimals)}function m(){for(l=n(),P<l-O.threshold&&(v.fps-=v.fps/Math.max(1,60*O.smoothing/O.interval),v.duration=1e3/v.fps),w=O.history;w--;)T[w]=0===w?v.fps:T[w-1],j[w]=0===w?v.duration:j[w-1];if(r(),O.heat){if(z.length)for(w=z.length;w--;)z[w].el.style[o[z[w].name].heatOn]=q?g(o[z[w].name].heatmap,v.fps,0,O.maxFps):g(o[z[w].name].heatmap,v.duration,O.threshold,0);if(F.graph&&o.column.heatOn)for(w=C.length;w--;)C[w].style[o.column.heatOn]=q?g(o.column.heatmap,T[w],0,O.maxFps):g(o.column.heatmap,j[w],O.threshold,0)}if(F.graph)for(y=0;y<O.history;y++)C[y].style.height=(q?T[y]?Math.round(x/O.maxFps*Math.min(T[y],O.maxFps)):0:j[y]?Math.round(x/O.threshold*Math.min(j[y],O.threshold)):0)+"px"}function k(){20>O.interval?(p=i(k),m()):(p=setTimeout(k,O.interval),f=i(m))}function G(t){(t=t||window.event).preventDefault?(t.preventDefault(),t.stopPropagation()):(t.returnValue=!1,t.cancelBubble=!0),v.toggle()}function U(){O.toggleOn&&S(F.container,O.toggleOn,G,1),t.removeChild(F.container)}function V(){if(F.container&&U(),o=D.theme[O.theme],!(h=o.compiledHeatmaps||[]).length&&o.heatmaps.length){for(y=0;y<o.heatmaps.length;y++)for(h[y]=[],w=0;w<=M;w++){var e,n=h[y],a=w;e=.33/M*w;var i=o.heatmaps[y].saturation,l=o.heatmaps[y].lightness,p=void 0,c=void 0,u=void 0,d=u=void 0,f=p=c=void 0;f=void 0;0===(u=.5>=l?l*(1+i):l+i-l*i)?e="#000":(c=(u-(d=2*l-u))/u,f=(e*=6)-(p=Math.floor(e)),f*=u*c,0===p||6===p?(p=u,c=d+f,u=d):1===p?(p=u-f,c=u,u=d):2===p?(p=d,c=u,u=d+f):3===p?(p=d,c=u-f):4===p?(p=d+f,c=d):(p=u,c=d,u-=f),e="#"+N(p)+N(c)+N(u)),n[a]=e}o.compiledHeatmaps=h}for(var b in F.container=s(document.createElement("div"),o.container),F.count=F.container.appendChild(s(document.createElement("div"),o.count)),F.legend=F.container.appendChild(s(document.createElement("div"),o.legend)),F.graph=O.graph?F.container.appendChild(s(document.createElement("div"),o.graph)):0,z.length=0,F)F[b]&&o[b].heatOn&&z.push({name:b,el:F[b]});if(C.length=0,F.graph)for(F.graph.style.width=O.history*o.column.width+(O.history-1)*o.column.spacing+"px",w=0;w<O.history;w++)C[w]=F.graph.appendChild(s(document.createElement("div"),o.column)),C[w].style.position="absolute",C[w].style.bottom=0,C[w].style.right=w*o.column.width+w*o.column.spacing+"px",C[w].style.width=o.column.width+"px",C[w].style.height="0px";s(F.container,O),r(),t.appendChild(F.container),F.graph&&(x=F.graph.clientHeight),O.toggleOn&&("click"===O.toggleOn&&(F.container.style.cursor="pointer"),S(F.container,O.toggleOn,G))}"object"===H(t)&&undefined===t.nodeType&&(e=t,t=document.body),t||(t=document.body);var o,h,l,p,f,x,b,w,y,v=this,O=I({},D.defaults,e||{}),F={},C=[],M=100,z=[],E=O.threshold,A=0,P=n()-E,T=[],j=[],q="fps"===O.show;v.options=O,v.fps=0,v.duration=0,v.isPaused=0,v.tickStart=function(){A=n()},v.tick=function(){l=n(),E+=(l-P-E)/O.smoothing,v.fps=1e3/E,v.duration=A<P?E:l-A,P=l},v.pause=function(){return p&&(v.isPaused=1,clearTimeout(p),a(p),a(f),p=f=0),v},v.resume=function(){return p||(v.isPaused=0,k()),v},v.set=function(t,e){return O[t]=e,q="fps"===O.show,-1!==R(t,u)&&V(),-1!==R(t,d)&&s(F.container,O),v},v.showDuration=function(){return v.set("show","ms"),v},v.showFps=function(){return v.set("show","fps"),v},v.toggle=function(){return v.set("show",q?"ms":"fps"),v},v.hide=function(){return v.pause(),F.container.style.display="none",v},v.show=function(){return v.resume(),F.container.style.display="block",v},v.destroy=function(){v.pause(),U(),v.tick=v.tickStart=function(){}},V(),k()}var n,o=t.performance;n=o&&(o.now||o.webkitNow)?o[o.now?"now":"webkitNow"].bind(o):function(){return+new Date};for(var a=t.cancelAnimationFrame||t.cancelRequestAnimationFrame,i=t.requestAnimationFrame,h=0,l=0,p=(o=["moz","webkit","o"]).length;l<p&&!a;++l)i=(a=t[o[l]+"CancelAnimationFrame"]||t[o[l]+"CancelRequestAnimationFrame"])&&t[o[l]+"RequestAnimationFrame"];a||(i=function(e){var o=n(),a=Math.max(0,16-(o-h));return h=o+a,t.setTimeout((function(){e(o+a)}),a)},a=function(t){clearTimeout(t)});var c="string"===H(document.createElement("div").textContent)?"textContent":"innerText";D.extend=I,window.FPSMeter=D,D.defaults={interval:100,smoothing:10,show:"fps",toggleOn:"click",decimals:1,maxFps:60,threshold:100,position:"absolute",zIndex:10,left:"5px",top:"5px",right:"auto",bottom:"auto",margin:"0 0 0 0",theme:"dark",heat:0,graph:0,history:20};var u=["toggleOn","theme","heat","graph","history"],d="position zIndex left top right bottom margin".split(" ")}(window),function(t,e){e.theme={};var n=e.theme.base={heatmaps:[],container:{heatOn:null,heatmap:null,padding:"5px",minWidth:"95px",height:"30px",lineHeight:"30px",textAlign:"right",textShadow:"none"},count:{heatOn:null,heatmap:null,position:"absolute",top:0,right:0,padding:"5px 10px",height:"30px",fontSize:"24px",fontFamily:"Consolas, Andale Mono, monospace",zIndex:2},legend:{heatOn:null,heatmap:null,position:"absolute",top:0,left:0,padding:"5px 10px",height:"30px",fontSize:"12px",lineHeight:"32px",fontFamily:"sans-serif",textAlign:"left",zIndex:2},graph:{heatOn:null,heatmap:null,position:"relative",boxSizing:"padding-box",MozBoxSizing:"padding-box",height:"100%",zIndex:1},column:{width:4,spacing:1,heatOn:null,heatmap:null}};e.theme.dark=e.extend({},n,{heatmaps:[{saturation:.8,lightness:.8}],container:{background:"#222",color:"#fff",border:"1px solid #1a1a1a",textShadow:"1px 1px 0 #222"},count:{heatOn:"color"},column:{background:"#3f3f3f"}}),e.theme.light=e.extend({},n,{heatmaps:[{saturation:.5,lightness:.5}],container:{color:"#666",background:"#fff",textShadow:"1px 1px 0 rgba(255,255,255,.5), -1px -1px 0 rgba(255,255,255,.5)",boxShadow:"0 0 0 1px rgba(0,0,0,.1)"},count:{heatOn:"color"},column:{background:"#eaeaea"}}),e.theme.colorful=e.extend({},n,{heatmaps:[{saturation:.5,lightness:.6}],container:{heatOn:"backgroundColor",background:"#888",color:"#fff",textShadow:"1px 1px 0 rgba(0,0,0,.2)",boxShadow:"0 0 0 1px rgba(0,0,0,.1)"},column:{background:"#777",backgroundColor:"rgba(0,0,0,.2)"}}),e.theme.transparent=e.extend({},n,{heatmaps:[{saturation:.8,lightness:.5}],container:{padding:0,color:"#fff",textShadow:"1px 1px 0 rgba(0,0,0,.5)"},count:{padding:"0 5px",height:"40px",lineHeight:"40px"},legend:{padding:"0 5px",height:"40px",lineHeight:"42px"},graph:{height:"40px"},column:{width:5,background:"#999",heatOn:"backgroundColor",opacity:.5}})}(window,FPSMeter));var Fps=pc.createScript("fps");Fps.prototype.initialize=function(){this.fps=new FPSMeter({heat:!0,graph:!0})},Fps.prototype.update=function(t){this.fps.tick()};var GameScaler=pc.createScript("gameScaler");GameScaler.DEFAULT_ORTHO_THIN_PHONE=5,GameScaler.DEFAULT_ORTHO_PHONE=5.5,GameScaler.DEFAULT_ORTHO_TABLET=8,GameScaler.DEFAULT_RATIO=9/16,GameScaler.prototype.initialize=function(){this.checkResolutionAndResize(),window.addEventListener("resize",this.checkResolutionAndResize.bind(this))},GameScaler.prototype.checkResolutionAndResize=function(){var e=this.entity.camera;if(e){var t=this.aspectRatio();e.orthoHeight=this.responsiveOrtho(GameScaler.DEFAULT_RATIO,t)}},GameScaler.prototype.aspectRatio=function(){return window.innerWidth/window.innerHeight},GameScaler.prototype.isTablet=function(){var e=this.aspectRatio();return Math.abs(e-3/4)<.1||Math.abs(e-2/3)<.1||Math.abs(e-18/21)<.1},GameScaler.prototype.isThinScreen=function(){var e=this.aspectRatio();return Math.abs(e-9/21.6)<.05||Math.abs(e-9/23.1)<.05},GameScaler.prototype.responsiveOrtho=function(e,t){return(this.isTablet()?GameScaler.DEFAULT_ORTHO_TABLET:this.isThinScreen()?GameScaler.DEFAULT_ORTHO_THIN_PHONE:GameScaler.DEFAULT_ORTHO_PHONE)*e/t};